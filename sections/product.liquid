{% comment %}
  This section is used in the product template to render product page with
  media, content, and add-to-cart form.

  https://shopify.dev/docs/storefronts/themes/architecture/templates/product
{% endcomment %}
<style>
  /* === Estilos SOLO para esta sección === */
  #shopify-section-{{ section.id }} [data-swiper-el] {
    /* 1 y 3) Color de flechas + tamaño del ícono de flecha */
    --swiper-navigation-color: var(--color-brown-dark); /* cambia a tu color */
    --swiper-navigation-size: 20px; /* tamaño del ícono (default ~44px) */
    /* 2) Color base de bullets (afecta el activo si no lo sobreescribes abajo) */
    --swiper-pagination-color: var(--color-brown-dark);
  }

  /* Si quieres que el ACTIVO tenga un color distinto al resto, sobreescribe: */
  #shopify-section-{{ section.id }} [data-swiper-el] .swiper-pagination-bullet {
    background: rgba(0,0,0,.25);  /* color bullets inactivos */
    opacity: 1;                    /* (opcional) todos visibles */
  }
  #shopify-section-{{ section.id }} [data-swiper-el] .swiper-pagination-bullet-active {
    background: var(--color-brown-dark); /* color bullet activo */
  }

  /* 3) (Opcional) Aumentar área clickeable de las flechas */
  #shopify-section-{{ section.id }} [data-swiper-el] .swiper-button-prev,
  #shopify-section-{{ section.id }} [data-swiper-el] .swiper-button-next {
    width: 44px;   /* target más grande para accesibilidad */
    height: 44px;
  }
</style>

<main id="MainContent" class="pb-[var(--buybar-h)]">
  <section
    class="product-gallery w-full"
    data-swiper-gallery
    role="region"
    aria-label="Galería de imágenes del producto"
  >
    <div
      class="swiper w-full overflow-hidden"
      data-swiper-el
      aria-roledescription="carousel"
      aria-label="Carrusel de imágenes"
    >
      <div class="swiper-wrapper items-stretch">
        {%- if product.media and product.media.size > 0 -%}
          {%- for media in product.media -%}
            <div class="swiper-slide flex items-center justify-center min-h-[280px]">
              {%- render 'product-media', media: media -%}
            </div>
          {%- endfor -%}
        {%- endif -%}
      </div>

      <div class="swiper-pagination" aria-label="Paginación de la galería"></div>
      <div class="swiper-button-prev" aria-label="Anterior"></div>
      <div class="swiper-button-next" aria-label="Siguiente"></div>
    </div>
  </section>

  <section class="product-information p-4" aria-labelledby="product-title">
    <header>
      <h1 id="product-title" class="text-[var(--color-orange-dark)] text-xl font-bold">
        {{ product.title | escape }}
      </h1>
    </header>

    {%- assign rating_value = product.metafields.reviews.rating.value | default: 4.85 -%}
    {%- assign rating_value_rounded = rating_value | round: 2 -%}
    {%- assign full_stars = rating_value | floor -%}

    <div class="flex items-center" role="img" aria-label="Calificación {{ rating_value_rounded }} de 5">
      {%- for i in (1..5) -%}
        {%- if i <= full_stars -%}
          {% render 'icon-start', class: 'size-3 text-[var(--color-brown-dark)]' %}
        {%- else -%}
          {% render 'icon-start', class: 'size-3 text-gray-400' %}
        {%- endif -%}
      {%- endfor -%}
      <p class="ms-1 text-xs font-medium text-gray-500">{{ rating_value_rounded }} / 5</p>
    </div>

    <div
      id="buybar"
      class="fixed inset-x-0 bottom-0 z-50 border-t border-black/10 bg-white/95 backdrop-blur"
      style="--buybar-h: 164px;"
    >
      <div class="mx-auto max-w-5xl px-4 pt-3 pb-[max(12px,env(safe-area-inset-bottom))]">
        <div>
          <div class="grid grid-cols-3 gap-3">
            <label class="block rounded-md border border-[var(--color-yellow-light)] px-3 pt-5 pb-3 text-center transition-colors has-[:checked]:bg-[var(--color-yellow-light)]">
              <input type="radio" name="opcion" value="1" class="sr-only">
              <div class="text-base font-semibold leading-none">$69.900</div>
              <div class="text-xs mt-1">1 arnés</div>
            </label>

            <label class="relative block rounded-md border border-[var(--color-yellow-light)] px-3 pt-5 pb-3 text-center transition-colors has-[:checked]:bg-[var(--color-yellow-light)]">
              <span
                class="
                  absolute -top-2 left-1/2 -translate-x-1/2 z-10 rounded-md bg-[var(--color-orange-dark)]  px-3 py-0.5 min-w-[95px] text-center
                  text-[9px] font-bold uppercase tracking-wide text-white shadow
                "
              >
                Más vendido
              </span>
              <input type="radio" name="opcion" value="2" class="sr-only" checked>
              <div class="text-base font-semibold leading-none">$99.900</div>
              <div class="text-xs mt-1">2 arneses</div>
            </label>

            <label class="block rounded-md border border-[var(--color-yellow-light)] px-3 pt-5 pb-3 text-center transition-colors has-[:checked]:bg-[var(--color-yellow-light)]">
              <input type="radio" name="opcion" value="3" class="sr-only">
              <div class="text-base font-semibold leading-none">$119.900</div>
              <div class="text-xs mt-1">3 arneses</div>
            </label>
          </div>

          <button
            class="mt-3 mb-3 w-full rounded-md bg-[var(--color-orange)] py-3 text-center font-semibold text-white hover:bg-[var(--color-orange-dark)] transition-colors"
          >
            Añadir al carrito
          </button>
        </div>
      </div>
    </div>

    <div aria-label="Descripción del producto">
      {{ product.description }}
    </div>
  </section>
</main>
